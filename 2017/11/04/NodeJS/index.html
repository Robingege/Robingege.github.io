<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="NodeJS," />










<meta name="description" content="NodeJS什么是  Node Node.js® is a JavaScript runtime built on Chrome’s V8 JavaScript engine. Node.js uses an event-driven, non-blocking I/O model that makes it lightweight and efficient. Node.js’ package">
<meta name="keywords" content="NodeJS">
<meta property="og:type" content="article">
<meta property="og:title" content="NodeJS 基础">
<meta property="og:url" content="http://yoursite.com/2017/11/04/NodeJS/index.html">
<meta property="og:site_name" content="Hello World">
<meta property="og:description" content="NodeJS什么是  Node Node.js® is a JavaScript runtime built on Chrome’s V8 JavaScript engine. Node.js uses an event-driven, non-blocking I/O model that makes it lightweight and efficient. Node.js’ package">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2017-11-04T05:10:08.224Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="NodeJS 基础">
<meta name="twitter:description" content="NodeJS什么是  Node Node.js® is a JavaScript runtime built on Chrome’s V8 JavaScript engine. Node.js uses an event-driven, non-blocking I/O model that makes it lightweight and efficient. Node.js’ package">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/11/04/NodeJS/"/>





  <title>NodeJS 基础 | Hello World</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hello World</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Hello Your</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/04/NodeJS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Robin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/robin.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hello World">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">NodeJS 基础</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-04T00:00:00+08:00">
                2017-11-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/学习/" itemprop="url" rel="index">
                    <span itemprop="name">学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="NodeJS"><a href="#NodeJS" class="headerlink" title="NodeJS"></a>NodeJS</h1><h3 id="什么是-Node"><a href="#什么是-Node" class="headerlink" title="什么是  Node"></a>什么是  Node</h3><blockquote>
<p>Node.js® is a JavaScript runtime built on <a href="https://developers.google.com/v8/" target="_blank" rel="external">Chrome’s V8 JavaScript engine</a>. Node.js uses an event-driven, non-blocking I/O model that makes it lightweight and efficient. Node.js’ package ecosystem, <a href="https://www.npmjs.com/" target="_blank" rel="external">npm</a>, is the largest ecosystem of open source libraries in the world.                  –选自：<a href="https://nodejs.org/en/" target="_blank" rel="external">https://nodejs.org/en/</a></p>
<p>翻译：</p>
<p>1) Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境。<br>2) Node.js 使用了一个事件驱动、非阻塞式 I/O 的模型，使其轻量又高效。<br>3) Node.js 的包管理器 npm，是全球最大的开源库生态系统</p>
<p>​                                –选自：<a href="http://nodejs.cn/" target="_blank" rel="external">http://nodejs.cn/</a></p>
</blockquote>
<ul>
<li><p>NodeJS 是一个构建于Chrome V8 引擎之上的一个JavaScript的运行时环境</p>
</li>
<li><p>Node 可以像浏览器一样去解析和执行JavaScript代码  </p>
</li>
<li><p>JavaScript 特点：</p>
<ul>
<li>动态语言<ul>
<li>预编译</li>
<li>再执行</li>
</ul>
</li>
<li>编译和执行都在浏览器环境中完成<ul>
<li>JavaScript包括<ul>
<li>ECMAScript<ul>
<li>var</li>
<li>if</li>
<li>while</li>
<li>function</li>
<li>Date</li>
<li>Math</li>
<li>….</li>
</ul>
</li>
<li>DOM<ul>
<li>document</li>
</ul>
</li>
<li>BOM<ul>
<li>window</li>
</ul>
</li>
</ul>
</li>
<li>通过编译解析引擎解析和执行JavaScript脚本代码</li>
<li>Chorme V8 引擎是所有浏览器里面解析和执行js最快的</li>
</ul>
</li>
</ul>
</li>
<li><p>NodeJS特点：</p>
<ul>
<li>NodeJS 的作者将 Chrome 的 V8 引擎移植出来，作为NodeJS 的运行时环境</li>
<li>在Node 中，没有界面，没有样式（不需要再关心HTML、CSS）</li>
<li>又基于 V8 引擎构建了一系列的API<ul>
<li>ECMASCript：<ul>
<li>var</li>
<li>if</li>
<li>while</li>
<li>function</li>
<li>Date</li>
<li>Math</li>
<li>….</li>
</ul>
</li>
<li>文件操作：(IO操作)文件的读取(0:output)/写入(I:input)</li>
<li>网络操作</li>
<li>….</li>
<li>让JavaSCript代码具有了服务器编程能力（使JavaScript代码成为了服务器端代码）</li>
</ul>
</li>
<li>事件驱动</li>
<li>非阻塞IO模型：大量的异步编程接口与<ul>
<li>ajax 一样的 API 调用方式</li>
<li>异步：回调</li>
</ul>
</li>
<li>跨平台</li>
<li>单线程</li>
<li>轻量和高效</li>
<li>Node.js 的包管理器 npm，是全球最大的开源库生态系统<ul>
<li>npm 是世界上最大的开源生态系统</li>
<li>在 npm 上发布的第三方包已经接近  <strong>35</strong>  万个之多</li>
<li>每个包只能解决单一问题，解决不了业务</li>
</ul>
</li>
</ul>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Chrome V8引擎</div><div class="line">    浏览器内核可以分为两个部分，即：渲染引擎和JS引擎。</div><div class="line">    渲染引擎：负责对网页语法的解释（如HTML、JavaScript）并渲染网页。 所以，通常所谓的浏览器内核也就是浏览器所采用的渲染引擎，渲染引擎决定了浏览器如何显示网页的内容以及页面的格式信息。不同的浏览器内核对网页编写语法 的解释也有不同，因此同一网页在不同的内核的浏览器里的渲染（显示）效果也可能不同，这也是网页编写者需要在不同内核的浏览器中测试网页显示效果的原因。</div><div class="line">    JS引擎：解析 Javascript语言，执行 javascript语言来实现网页的动态效果</div><div class="line">    Chrome V8引擎：作为一个 JavaScript 引擎，最初是服役于 Google Chrome 浏览器的。它随着 Chrome 的第一版发布而发布以及开源。现在它除了 Chrome 浏览器，已经有很多其他的使用者了。诸如 NodeJS、MongoDB、CouchDB 等。</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="为什么要学习NodeJS"><a href="#为什么要学习NodeJS" class="headerlink" title="为什么要学习NodeJS"></a>为什么要学习NodeJS</h3><ul>
<li>打开服务器的黑盒子</li>
<li>满足公司的招聘需求：需要具有一定的服务器开发经验</li>
<li>提供更广阔的发展前景：如果是纯粹的前端想要向高级前端发展，服务端就是瓶颈</li>
<li>成为全栈的必经之路</li>
</ul>
<h3 id="Node-应用场景"><a href="#Node-应用场景" class="headerlink" title="Node 应用场景"></a>Node 应用场景</h3><ul>
<li>提供服务（Java , PHP , C#, Python , Ruby 等服务器语言能做的Node都能做）</li>
<li>网站开发，提供网站服务器</li>
<li>数据库交互</li>
<li>移动应用：后台</li>
<li>网络游戏：后台</li>
<li>CLI （Commond Line Interface）程序：<ul>
<li>git</li>
<li>gulp</li>
<li>hexo</li>
<li>Node 具有开发命令行工具的能力 <ul>
<li>webpack 打包构建工具</li>
<li>http-server 在终端中快速提供一个服务</li>
<li>borwer-sync 提供服务，提供浏览器自动刷新的能力</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="Node-的优势领域"><a href="#Node-的优势领域" class="headerlink" title="Node 的优势领域"></a>Node 的优势领域</h3><ul>
<li><p>对 IO 操作比较频繁的操作</p>
<ul>
<li>文件读写</li>
<li>和数据库交互：网络数据IO</li>
</ul>
</li>
<li><p>实时通信</p>
<ul>
<li><p>聊天软件：微信、QQ、直播</p>
<p>​</p>
</li>
</ul>
</li>
</ul>
<h3 id="NodeJS-学习资源"><a href="#NodeJS-学习资源" class="headerlink" title="NodeJS 学习资源"></a>NodeJS 学习资源</h3><ul>
<li>《Node.js 权威指南》：官方API详解：<a href="https://nodejs.org/dist/latest-v6.x/docs/api/" target="_blank" rel="external">https://nodejs.org/dist/latest-v6.x/docs/api/</a></li>
<li>JavaScript 标准参考教程（alpha）: <a href="http://javascript.ruanyifeng.com/nodejs/fs.html" target="_blank" rel="external">http://javascript.ruanyifeng.com/nodejs/fs.html</a></li>
<li>Node 入门：<a href="http://www.nodebeginner.org/index-zh-cn.html" target="_blank" rel="external">http://www.nodebeginner.org/index-zh-cn.html</a></li>
<li>中文文档（版本比较旧，凑合看）：<a href="http://www.nodeclass.com/api/node.html" target="_blank" rel="external">http://www.nodeclass.com/api/node.html</a></li>
<li>CNODE社区：<a href="http://cnodejs.org" target="_blank" rel="external">http://cnodejs.org</a></li>
<li>CNODE-新手入门：<a href="http://cnodejs.org/getstart" target="_blank" rel="external">http://cnodejs.org/getstart</a></li>
<li>Node.js包教不包会：<a href="https://github.com/alsotang/node-lessons" target="_blank" rel="external">https://github.com/alsotang/node-lessons</a></li>
<li>朴灵：《深入浅出Node.js》</li>
</ul>
<h3 id="NodeJS-安装"><a href="#NodeJS-安装" class="headerlink" title="NodeJS 安装"></a>NodeJS 安装</h3><ul>
<li>使用NodeJS 安装包安装<ul>
<li>安装方法，见：安装包—&gt;直接安装Node</li>
</ul>
</li>
<li>使用 nvm 安装和管理 Node<ul>
<li>安装方法，见：安装包—&gt;使用nvm安装</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">判断Node 是否安装成功的方法：</div><div class="line">	1.0 打开CMD</div><div class="line">	2.0 输入 node + 回车</div></pre></td></tr></table></figure>
<h3 id="Node-中的组成"><a href="#Node-中的组成" class="headerlink" title="Node 中的组成"></a>Node 中的组成</h3><ul>
<li>基本语法 ECMAScript<ul>
<li>var</li>
<li>if</li>
<li>while</li>
<li>function</li>
<li>Date</li>
<li>Math</li>
<li>console</li>
<li>定时器函数<ul>
<li>setTimeout  clearTimeout</li>
<li>setInterval  clearInterval</li>
</ul>
</li>
<li>global</li>
<li>….</li>
</ul>
</li>
<li>用户自定义模块<ul>
<li>关键字：<ul>
<li>reuqire：<ul>
<li>是一个函数，可以在任何NodeJS脚本文件中使用</li>
<li>作用：就是用来加载模块的（加载解析执行JavaScript脚本文件）</li>
<li>注意：加载自定义模块时一定要加上“./”，否则加载不出来</li>
</ul>
</li>
<li>module.exports：<ul>
<li>每个模块都会提供一个接口对象module.exports</li>
<li>作用：通过require加载可以得到模块返回的module.exports对象（相当于每个模块最后面都会有一句：reutrn module.exports）</li>
</ul>
</li>
<li>特点：<ul>
<li>自己写每个JS文件都是一个模块</li>
<li>模块天生就是一个私有的作用域</li>
<li>可能通过global设置全局变量（不建议）</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>第三方模块（由社区/公司/个人提供：如果jquery）<ul>
<li>所有第三方模块用法都差不多：<ol>
<li>通过npm 下载</li>
<li>通过require函引包</li>
<li>查看第三方包的 API 文档（例如：moment）</li>
</ol>
</li>
</ul>
</li>
<li>核心模块<ul>
<li>核心模块是由Node环境平台本身提供的</li>
<li>以一个唯一核心 模块标识名称进行暴露</li>
<li>使用的时候直接通 “require” 进行函数加载<ul>
<li>如：文件操作模块“fs”，网络操作模块“http”</li>
</ul>
</li>
</ul>
</li>
<li>总结：<ul>
<li>将来我们会结合以上的功能去开发 Node 应用程序，这里先宏观了解一下</li>
<li>模块的加载机制，会随着课程的深入再具体讲解。</li>
</ul>
</li>
</ul>
<h3 id="path-环境变量"><a href="#path-环境变量" class="headerlink" title="path 环境变量"></a>path 环境变量</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">问题：为什么不管我们把文件放在哪个目录下面，都可以在CMD中通过Node来运行文件？</div><div class="line"></div><div class="line">答案：环境变量。</div></pre></td></tr></table></figure>
<ul>
<li>什么是环境变量？<ul>
<li>在CMD中，我们输入一段字符时，系统会将字符当作一个程序去当前路径下面去找对应的程序，如果有，直接运行</li>
<li>如果没有，系统会去用户变量对应的路径下去找程序，如果能找到直接运行</li>
<li>如果没有， 系统会去系统变量对应的路径下去找程序，如果能找到，直接运行</li>
<li>如果都没有，报错</li>
</ul>
</li>
<li>path变量特点：<ul>
<li>由一个或者多个路径组成，路径之间以  <strong>英文分号</strong> 隔开</li>
<li>将来CMD会按照path中的路径一个一个去找对应的程序，如果有就运行，如果没有就出错</li>
<li>环境变量除了可以是直接放路径以外，还可以通过用户自己来创建一个变量，以： <strong>%变量名%</strong> 的形式添加到path中</li>
</ul>
</li>
</ul>
<h3 id="常用核心模块"><a href="#常用核心模块" class="headerlink" title="常用核心模块"></a>常用核心模块</h3><h4 id="NodeJS-版-hello-word"><a href="#NodeJS-版-hello-word" class="headerlink" title="NodeJS 版 hello word"></a>NodeJS 版 hello word</h4><pre><code>1. 创建一个文件，后缀名改为：.js
2. 在文件中输入 console.log(&quot;hello word&quot;); 
3. 使用 node 打开文件：
  方法一：通过 CMD 转到文件所在的路径下面：node + 文件名
  方法二：直接找到文件所在目录，在空白处：shift + 右键 ----&gt; 在此外打开命令窗口 ----&gt; 在cmd中输入: node + 文件名
</code></pre><h4 id="NodeJS-读写文件"><a href="#NodeJS-读写文件" class="headerlink" title="NodeJS 读写文件"></a>NodeJS 读写文件</h4><p>​    读文件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line">fs.readFile(<span class="string">"./01_hello word.js"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</div><div class="line">	<span class="keyword">if</span> (err) &#123;</div><div class="line">		<span class="built_in">console</span>.log(<span class="string">"读取出错"</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span> &#123;</div><div class="line">		<span class="built_in">console</span>.log(data.toString());</div><div class="line">	&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>​    写文件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">  <span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line">fs.writeFile(<span class="string">"./00selfbuild.js"</span>,<span class="string">"这是我自己写的内容"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span> (err) &#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"写入文件失败"</span>);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"写入完成"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="NodeJS-开启服务器"><a href="#NodeJS-开启服务器" class="headerlink" title="NodeJS 开启服务器"></a>NodeJS 开启服务器</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</div><div class="line"><span class="keyword">var</span> server = http.createServer();</div><div class="line">server.on(<span class="string">'request'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">request, response</span>) </span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">'收到客户端请求了'</span>);</div><div class="line">	response.write(<span class="string">'&lt;h1&gt;hello word&lt;/h1&gt;'</span>);</div><div class="line">	response.write(<span class="string">'over'</span>);</div><div class="line">	response.end();</div><div class="line">&#125;);</div><div class="line"></div><div class="line">server.listen( <span class="number">3000</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">'服务器启动成功'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="构建HTTP服务"><a href="#构建HTTP服务" class="headerlink" title="构建HTTP服务"></a>构建HTTP服务</h3><ul>
<li><p>编写一个响应 “hello word” 服务</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</div><div class="line"><span class="keyword">var</span> server = http.createServer();</div><div class="line">server.on(<span class="string">'request'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">request, response</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'收到客户端请求了'</span>);</div><div class="line">    response.write(<span class="string">'hello word'</span>);</div><div class="line">    response.end();</div><div class="line">&#125;);</div><div class="line">server.listen( <span class="number">3000</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'服务器启动成功'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<ul>
<li>注意：<ul>
<li>服务开启之后除了 request 中的内容会执行多次以外，其它的代码只会执行一行 </li>
<li>一个端口号只能被一个程序占用。</li>
</ul>
</li>
</ul>
</li>
<li><p>根据不同请求输出不同响应服务</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">          <span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</div><div class="line"><span class="keyword">var</span> server = http.createServer();</div><div class="line">          server.on(<span class="string">'request'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">request, response</span>) </span>&#123;</div><div class="line">          	<span class="keyword">var</span> url = request.url;</div><div class="line">          	<span class="keyword">if</span> ( url == <span class="string">'/'</span>) &#123;</div><div class="line">                	response.end(<span class="string">'home index'</span>);</div><div class="line">          	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (url == <span class="string">'/a'</span>)&#123;</div><div class="line">          		response.end(<span class="string">'aaa index'</span>);</div><div class="line">          	&#125;</div><div class="line">          &#125;);</div><div class="line">          server.listen( <span class="number">3000</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">              <span class="built_in">console</span>.log(<span class="string">'服务器启动成功'</span>);</div><div class="line">          &#125;);</div><div class="line">  注意：</div><div class="line">      所有请求都是以 “/” 开头的</div></pre></td></tr></table></figure>
</li>
<li><p>根据不同请求输出不同文件服务：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</div><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> server = http.createServer();</div><div class="line"></div><div class="line">server.on(<span class="string">'request'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"> req, res</span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> url = req.url;</div><div class="line">	<span class="keyword">if</span> (url == <span class="string">'/'</span>) &#123;</div><div class="line">		fs.readFile(<span class="string">'./temp/index.html'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>) </span>&#123;</div><div class="line">			res.end(data);</div><div class="line">		&#125;);</div><div class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> ( url == <span class="string">'/a'</span>) &#123;</div><div class="line">		res.end(<span class="string">'请求的是a'</span>);</div><div class="line">	&#125;</div><div class="line">&#125;);</div><div class="line">server.listen(<span class="number">3000</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">"服务器开启成功"</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<ul>
<li>注意：<ul>
<li>可以通过自己写的服务在不同的页面中跳转，跳转时可以不加ip和端口号</li>
<li>如果在自己的html页面中添加一些css文件/图片，那么将来服务是没有办法拿到css文件件/图片的。</li>
</ul>
</li>
</ul>
</li>
<li><p>构建一个类似于 Apache 的功能</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>); 	</div><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"><span class="keyword">var</span> server = http.createServer();</div><div class="line">server.on(<span class="string">'request'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"> req, res</span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> url = req.url;</div><div class="line">	<span class="keyword">var</span> filePath = <span class="string">'.'</span> + url;</div><div class="line">	fs.readFile( filePath, <span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>) </span>&#123;</div><div class="line">	   	<span class="keyword">if</span> (err) &#123;</div><div class="line">	        res.end(<span class="string">'404 Not Found'</span>)  </div><div class="line">	   	&#125; <span class="keyword">else</span> &#123;</div><div class="line">			res.end(data);</div><div class="line">		&#125;</div><div class="line">	 &#125;);</div><div class="line">&#125;);</div><div class="line">server.listen(<span class="number">3000</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	 <span class="built_in">console</span>.log(<span class="string">"服务器开启成功"</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<ul>
<li>注意：文件的命名不能以“/”开头，否则服务器会去当前文件处的磁盘根目录去找到文件</li>
</ul>
</li>
</ul>
<h3 id="渲染方式"><a href="#渲染方式" class="headerlink" title="渲染方式"></a>渲染方式</h3><ul>
<li><p>浏览器渲染</p>
<ul>
<li>特点<ul>
<li>从服务器得到数据</li>
<li>在浏览器中将数据进行渲染</li>
</ul>
</li>
<li>优点：<ul>
<li>第一次加载页面时数据相对而言会少一点</li>
<li>用户体验会好一点</li>
</ul>
</li>
<li>缺点：<ul>
<li>不利于SEO优化</li>
</ul>
</li>
</ul>
</li>
<li><p>服务器渲染</p>
<ul>
<li>特点：<ul>
<li>所有的数据在服务器端已经加载完毕</li>
<li>浏览器只负责渲染页面就可以</li>
</ul>
</li>
<li>优点：<ul>
<li>利于SEO优化</li>
</ul>
</li>
<li>缺点：<ul>
<li>第一次加载时速度会慢一点</li>
</ul>
</li>
</ul>
<p>​</p>
</li>
</ul>
<h3 id="文件操作的同步与异步"><a href="#文件操作的同步与异步" class="headerlink" title="文件操作的同步与异步"></a>文件操作的同步与异步</h3><ul>
<li><p>异步读取文件</p>
<figure class="highlight plain"><figcaption><span>fs </span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">console.log(&apos;111&apos;);</div><div class="line"></div><div class="line">fs.readFile(&apos;./a.txt&apos;,function(err,data) &#123;</div><div class="line"></div><div class="line">    console.log(&apos;222&apos;);</div><div class="line"></div><div class="line">&#125;);</div><div class="line"></div><div class="line">fs.readFile(&apos;./b.txt&apos;,function(err,data) &#123;</div><div class="line"></div><div class="line">    console.log(&apos;333&apos;);</div><div class="line"></div><div class="line">&#125;);</div><div class="line"></div><div class="line">fs.readFile(&apos;./c.txt&apos;,function(err,data) &#123;</div><div class="line"></div><div class="line">    console.log(&apos;444&apos;);</div><div class="line"></div><div class="line">&#125;);</div><div class="line"></div><div class="line">console.log(&apos;555&apos;);</div></pre></td></tr></table></figure>
</li>
<li><p>同步读取文件</p>
<pre><code>​<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">var fs = require(&apos;fs&apos;);</div><div class="line"></div><div class="line">console.log(&apos;111&apos;);</div><div class="line"></div><div class="line">var dataA = fs.readFileSync(&apos;./a.txt&apos;).toString();</div><div class="line">console.log(&apos;222&apos;);</div><div class="line">console.log(dataA);</div><div class="line"></div><div class="line">var dataB = fs.readFileSync(&apos;./a.txt&apos;).toString();</div><div class="line">console.log(&apos;333&apos;);</div><div class="line">console.log(dataB);</div><div class="line"></div><div class="line">var dataC = fs.readFileSync(&apos;./a.txt&apos;).toString();</div><div class="line">console.log(&apos;444&apos;);</div><div class="line">console.log(dataC);</div><div class="line"></div><div class="line">console.log(&apos;555&apos;);</div><div class="line">​</div></pre></td></tr></table></figure>
</code></pre></li>
<li><p>区别：</p>
<ul>
<li>异步：<ul>
<li>通过一个回调函数来获取异步操作结果</li>
<li>异步操作的回调函数第一个 参数：err<ul>
<li>如果操作成功：err 为null</li>
<li>如果操作失败：err 为 错误对象</li>
<li>所以在异步操作中，优先判断 err 是否出错</li>
<li>在异步操作中，无法通过try-catch来捕获异常</li>
</ul>
</li>
</ul>
</li>
<li>同步：<ul>
<li>直接等待代码读取完文件再去执行下面的代码</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="第三方模块：模板引擎的使用"><a href="#第三方模块：模板引擎的使用" class="headerlink" title="第三方模块：模板引擎的使用"></a>第三方模块：模板引擎的使用</h3><ul>
<li>总结：数据使用模板渲染即可以在浏览器端渲染，又可以在服务器端渲染.<ul>
<li>区别：<ol>
<li>在浏览器端渲染（如：京东商品的评论信息），可以使页面加载更快，用户体验更好</li>
<li>在服务器端渲染（如：京东商品数据），可以使页面利于SEO优化</li>
</ol>
</li>
</ul>
</li>
</ul>
<h3 id="得到文件的状态"><a href="#得到文件的状态" class="headerlink" title="得到文件的状态"></a>得到文件的状态</h3><ul>
<li>fs.stat(path, callback)<ul>
<li>作用：用来判断传入的路径的状态</li>
<li>参数：<ul>
<li>path：要传入的路径</li>
<li>callback：回调函数<ul>
<li>回调函数参数：<ul>
<li>err 目录出错时的对象</li>
<li>stat 路径的状态对象<ul>
<li>stat.isFile()：判断路径对应的是否是文件</li>
<li>stat.isDirectory()：判断路径对应的是否是文件夹</li>
<li>stat.size：得到对应路径文件的大小（如果路径对应的是文件夹，则得不到大小）</li>
<li>stat.mtime：得到应对路径文件的修改时间</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="使用-nodemon-实现改完代码服务自动重启"><a href="#使用-nodemon-实现改完代码服务自动重启" class="headerlink" title="使用 nodemon 实现改完代码服务自动重启"></a>使用 nodemon 实现改完代码服务自动重启</h3><ul>
<li><p>nodemon 是一个基于 Node 开发的一个命令行工具，</p>
<ul>
<li>可以实现监视代码改动，自动重启服务的功能。</li>
<li>本质还是通过 node 执行的咱们自己写的脚本代码。</li>
</ul>
</li>
<li><p>使用步骤：</p>
<ul>
<li><p>第一，安装 nodemon</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">简写：npm i -g nodemon</div><div class="line"></div><div class="line">全称：npm install --global nodemon</div></pre></td></tr></table></figure>
</li>
<li><p>第二，基本使用：</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">以前的做法：node app.js</div><div class="line"></div><div class="line">现在的做法：nodemon app.js</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="使用-nodemon-实现改完代码服务自动重启-1"><a href="#使用-nodemon-实现改完代码服务自动重启-1" class="headerlink" title="使用 nodemon 实现改完代码服务自动重启"></a>使用 nodemon 实现改完代码服务自动重启</h3><ul>
<li><p>nodemon 是一个基于 Node 开发的一个命令行工具，</p>
<ul>
<li>可以实现监视代码改动，自动重启服务的功能。</li>
<li>本质还是通过 node 执行的咱们自己写的脚本代码。</li>
</ul>
</li>
<li><p>使用步骤：</p>
<ul>
<li><p>第一，安装 nodemon</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">简写：npm i -g nodemon</div><div class="line">全称：npm install --global nodemon</div></pre></td></tr></table></figure>
</li>
<li><p>第二，基本使用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">以前的做法：node app.js</div><div class="line">现在的做法：nodemon app.js</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="CommonJS-规范："><a href="#CommonJS-规范：" class="headerlink" title="CommonJS 规范："></a>CommonJS 规范：</h3><ul>
<li><p>module对象</p>
<ul>
<li>module.exports</li>
<li>exports</li>
<li>在CommonJS 中规定：一个模块返回数据可以通过module.exports和rexports两个关键字来返回</li>
<li>模块最终返回的仅仅只是 modules.exports</li>
<li>exports 仅仅只是 modules.exports的一个引用</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">验证module.exports与exports的关系：</div><div class="line">	1）console.log(module.exports === exports);</div><div class="line">	2）exports.a = 123;</div><div class="line">	3）exports = fucntion() &#123;&#125;</div><div class="line">	4）exports = modules.exports =  fucntion() &#123;&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>模块加载机制</p>
<ul>
<li><p>require关键字：</p>
<ul>
<li>可以帮助一个模块加载另一个模块</li>
</ul>
</li>
<li><p>优先从缓存中加载</p>
<ul>
<li>Node 加载模块时，如果这个模块已经被加载过了，则会直接缓存起来，将来再次引用时不会再次加加载这个模块（即：如果一个模块被加载两次，则模块中的代码只会被执行一次）</li>
<li>加载模块本质上是加载模块中的modules.exports值</li>
</ul>
</li>
<li><p>核心模块</p>
<ul>
<li>先去缓存中看下是否存在，如果有，直接拿来使用</li>
<li>如果没有，则加载</li>
</ul>
</li>
<li><p>自定义模块</p>
<ul>
<li>以 ‘./‘ 或者 ‘../‘ 或者 ‘c:/xxx’ 类似于这样的标识路径作为加载名</li>
</ul>
</li>
<li><p>第三方模块：包</p>
<ul>
<li>先在当前文件的模块所属目录去找 node_modules目录</li>
<li>如果找到，则去该目录中找 moment 目录</li>
<li>如果找到 moment 目录， 则找该目录中的 package.json文件</li>
<li>如果找到 package.json 文件，则找该文件中的 main属性</li>
<li>如果找到main 属性，则拿到该属性对应的文件</li>
<li>如果找到 moment 目录之后，<ul>
<li>没有package.json</li>
<li>或者有 package.json 没有 main 属性</li>
<li>或者有 main 属性，但是指向的路径不存在 </li>
<li>则 node 会默认去看一下 moment 目录中有没有 index.js ,index.node, index.json 文件</li>
</ul>
</li>
<li>如果找不到index 或者 找不到 moment 或者找不到 node_modules </li>
<li>则进入上一级目录找 node_moudles 查找（规则同上）</li>
<li>如果上一级还找不到，继续向上，一直到当前文件所属磁盘的根目录</li>
<li>如果到磁盘概目录还没有找到，直接报错</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">核心模块：</div><div class="line">	由 Node 本身提供，通过唯一的模块标识名进行加载</div><div class="line">	核心模块本质上也是文件模块，它已经被编译到可执行文件中了</div><div class="line">第三方模块</div><div class="line">用户自定义模块</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>模块的兼容处理</p>
<ul>
<li><p>有些模块即能在浏览器端使用，又能在服务器端使用，是因为它们作了兼容处理（如：moment）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">(function (global, factory) &#123;</div><div class="line">    typeof exports === &apos;object&apos; &amp;&amp; typeof module !== &apos;undefined&apos; ? module.exports = factory() :typeof define === &apos;function&apos; &amp;&amp; define.amd ? define(factory) :</div><div class="line">    global.moment = factory()</div><div class="line">&#125;(this, (function () &#123; &apos;use strict&apos;;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="文件上传第三方包：formidable"><a href="#文件上传第三方包：formidable" class="headerlink" title="文件上传第三方包：formidable"></a>文件上传第三方包：formidable</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">在表单中如果想上传文件必须将表单中的属性：enctype 设置为 multipart/form-data才可以。</div></pre></td></tr></table></figure>
<h2 id="Express"><a href="#Express" class="headerlink" title="Express"></a>Express</h2><ul>
<li>作者：<a href="https://github.com/tj" target="_blank" rel="external">https://github.com/tj</a></li>
<li>Github：<a href="https://github.com/expressjs/express" target="_blank" rel="external">https://github.com/expressjs/express</a></li>
<li>官网：<a href="http://expressjs.com/" target="_blank" rel="external">http://expressjs.com/</a></li>
<li>中文翻译：<a href="http://www.expressjs.com.cn/" target="_blank" rel="external">http://www.expressjs.com.cn/</a></li>
<li>awesome-express: <a href="https://github.com/wabg/awesome-express" target="_blank" rel="external">https://github.com/wabg/awesome-express</a></li>
</ul>
<h3 id="起步"><a href="#起步" class="headerlink" title="起步"></a>起步</h3><p>安装：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install --save express</div></pre></td></tr></table></figure>
<p>hello world：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</div><div class="line"><span class="keyword">var</span> app = express()</div><div class="line"></div><div class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</div><div class="line">  res.send(<span class="string">'Hello World!'</span>)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">app.listen(<span class="number">3000</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Example app listening on port 3000!'</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>基本路由：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</div><div class="line">  res.send(<span class="string">'Hello World!'</span>)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">app.post(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</div><div class="line">  res.send(<span class="string">'Got a POST request'</span>)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">app.put(<span class="string">'/user'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</div><div class="line">  res.send(<span class="string">'Got a PUT request at /user'</span>)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">app.delete(<span class="string">'/user'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</div><div class="line">  res.send(<span class="string">'Got a DELETE request at /user'</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Express-中外置路由使用"><a href="#Express-中外置路由使用" class="headerlink" title="Express 中外置路由使用"></a>Express 中外置路由使用</h3><p>router.js 文件代码如下:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 1. 加载 express 模块</span></div><div class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</div><div class="line"></div><div class="line"><span class="comment">// 2. 调用 express.Router() 方法，得到一个路由容器实例</span></div><div class="line"><span class="keyword">var</span> router = express.Router()</div><div class="line"></div><div class="line"><span class="comment">// 3. 为 router 添加不同的路由</span></div><div class="line">router.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</div><div class="line">  res.send(<span class="string">'hello express'</span>)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">router.get(<span class="string">'/add'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</div><div class="line"></div><div class="line">&#125;)</div><div class="line"></div><div class="line">router.get(<span class="string">'/info'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</div><div class="line"></div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// 4. 将 router 路由容器导出</span></div><div class="line"><span class="built_in">module</span>.exports = router</div></pre></td></tr></table></figure>
<p>在 app.js 文件中：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</div><div class="line"></div><div class="line"><span class="comment">// 1. 加载路由模块</span></div><div class="line"><span class="keyword">var</span> router = <span class="built_in">require</span>(<span class="string">'./router'</span>)</div><div class="line"></div><div class="line"><span class="keyword">var</span> app = express()</div><div class="line"></div><div class="line"><span class="comment">// 2. 将路由模块导出的路由容器 router 通过 app.use() 方法挂载到 app 实例上</span></div><div class="line"><span class="comment">//    这样的话咱们的 app 实例程序就拥有了 router 的路由了</span></div><div class="line">app.use(router)</div><div class="line"></div><div class="line">app.listen(<span class="number">3000</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'running...'</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="在-Express-中处理静态资源"><a href="#在-Express-中处理静态资源" class="headerlink" title="在 Express 中处理静态资源"></a>在 Express 中处理静态资源</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">app.use(express.static(<span class="string">'public'</span>))</div><div class="line">app.use(express.static(<span class="string">'files'</span>))</div><div class="line"></div><div class="line">app.use(<span class="string">'/public'</span>, express.static(<span class="string">'public'</span>))</div><div class="line">app.use(<span class="string">'/aaa'</span>, express.static(<span class="string">'public'</span>))</div><div class="line"></div><div class="line">app.use(<span class="string">'/static'</span>, express.static(path.join(__dirname, <span class="string">'public'</span>)))</div></pre></td></tr></table></figure>
<h3 id="使用-Express-中的路由"><a href="#使用-Express-中的路由" class="headerlink" title="使用 Express 中的路由"></a>使用 Express 中的路由</h3><h3 id="art-template-在-exporess-中的使用"><a href="#art-template-在-exporess-中的使用" class="headerlink" title="art-template 在 exporess 中的使用"></a>art-template 在 exporess 中的使用</h3><pre><code>#### 步骤
</code></pre><ul>
<li>1.0 引用</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var template = require(&apos;art-template&apos;);</div></pre></td></tr></table></figure>
<ul>
<li>2.0 注册代码</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">template.config(&apos;base&apos;, &apos;&apos;);</div><div class="line">template.config(&apos;extname&apos;, &apos;.html&apos;);</div><div class="line">app.engine(&apos;.html&apos;, template.__express);</div><div class="line">app.set(&apos;view engine&apos;, &apos;html&apos;);</div></pre></td></tr></table></figure>
<ul>
<li><p>3.0 接下来使用起来与在NodeJS 自定义服务器下一样</p>
<p>​</p>
</li>
</ul>
<h2 id="MongoDB"><a href="#MongoDB" class="headerlink" title="MongoDB"></a>MongoDB</h2><blockquote>
<p>为了更好的学习 MongoDB 数据库，大家可以参考菜鸟教程上的 MongoDB 数据库教程文档，<br>链接地址：<a href="http://www.runoob.com/mongodb/mongodb-tutorial.html" target="_blank" rel="external">http://www.runoob.com/mongodb/mongodb-tutorial.html</a></p>
</blockquote>
<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><ul>
<li>非关系型数据库<ul>
<li>不需要提前设计表结构</li>
<li>最大的好处就是非常灵活</li>
<li>存储的是 json 数据</li>
<li>非关系型数据库也有很多，其中 MongoDB 就是佼佼者</li>
</ul>
</li>
<li>关系型数据库<ul>
<li>MySQL</li>
<li>Oracle</li>
<li>DB2</li>
<li>Microsoft SqlServer</li>
<li>所有关系型数据库都差不多</li>
<li>都是表、关系、表中的字段数据，表与表之间的关系</li>
<li>共同点：必须先有表结构才可以操作这个表</li>
<li>而且如果随着业务场景的不断演变，你会发现表需要频繁的去修改</li>
</ul>
</li>
</ul>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><h3 id="启动和停止"><a href="#启动和停止" class="headerlink" title="启动和停止"></a>启动和停止</h3><p>可以通过使用安装程序中的 <code>mongod</code> CLI应用程序来启动 MongoDB 服务。<br>直接在控制台输入：<code>mongod</code> 敲回车即可。</p>
<p>在启动的时候，可以通过 <code>--dbpath</code> 指定数据服务存储数据的目录，<br>如果不指定该目录，<br>默认 <code>mongod</code> 会去执行该命令的当前目录所属磁盘根目录下找<code>/data/db</code> 作为自己的数据存储目录。</p>
<p>64 位版本启动 MongoDB 数据服务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mongod --dbpath=C:\data\db</div><div class="line">mongod --dbpath C:\data\db</div></pre></td></tr></table></figure>
<p>32 位版本使用下面的命令启动数据服务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mongod --dbpath 数据存储路径 --journal --storageEngine=mmapv1</div></pre></td></tr></table></figure>
<p>提示：如果不加 <code>--dbpath</code>, mongod 会自动使用 <code>执行命令所属磁盘根目录/data/db</code> 目录作为自己的数据存储路径，<br>所以，如果当前磁盘已经有了 <code>磁盘根路径\data\db</code> 目录了，可以省略 <code>--dbpath</code>。</p>
<p>执行完上面的命令并成功开启 MongoDB 数据服务实例之后，就把该控制台最小化到一边就可以了，<br>千万不要关闭，否则关闭终端就是关闭数据库了，<br>如果对数据库的操作结束，可以打开该控制台通过 <code>Ctrl + C</code> 关闭或者直接关闭终端。</p>
<h3 id="连接-MongoDB"><a href="#连接-MongoDB" class="headerlink" title="连接 MongoDB"></a>连接 MongoDB</h3><p><strong>注意：在进行连接之前请确保你的服务实例是开启状态的（不要关闭刚才开启的数据服务实例）。</strong></p>
<p>打开一个新的控制台，在控制台输入以下命令用来连接本机的 MongoDB 服务实例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mongo</div></pre></td></tr></table></figure>
<p>mongo 命令默认去连接本机上的 MongoDB 服务实例：<code>127.0.0.1:27017</code>，可以通过下面的命令<br>指定连接的主机名和端口号：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mongo --host 127.0.0.1 --port 27017</div></pre></td></tr></table></figure>
<p>如果看到类似于如下的字样说明连接成功：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">MongoDB shell version v3.4.0</div><div class="line">connecting to: mongodb://127.0.0.1:27017</div><div class="line">MongoDB server version: 3.4.0</div><div class="line">Server has startup warnings:</div><div class="line">2017-01-18T18:49:53.865+0800 I CONTROL  [initandlisten]</div><div class="line">2017-01-18T18:49:53.865+0800 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.</div><div class="line">2017-01-18T18:49:53.866+0800 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.</div><div class="line">2017-01-18T18:49:53.866+0800 I CONTROL  [initandlisten]</div><div class="line">&gt;</div></pre></td></tr></table></figure>
<p>如果提示 “无法连接主机”，请检查你的 MongoDB 数据服务实例是否开启。</p>
<h3 id="MongoDB-数据存储结构"><a href="#MongoDB-数据存储结构" class="headerlink" title="MongoDB 数据存储结构"></a>MongoDB 数据存储结构</h3><ul>
<li>传统的关系型数据库中存储结构<ul>
<li>一个机器上安装数据库其实就是安装了一个数据服务实例</li>
<li>一个数据服务实例上可以有多个数据库<ul>
<li>a 网站的用户</li>
<li>b 网站的用户</li>
<li>a 网站的用户表、b 网站的用户表</li>
</ul>
</li>
<li>一个数据库中可以有多张表</li>
<li>一张表中可以存储多条记录数据</li>
</ul>
</li>
<li>数据服务实例 -&gt; 数据库 -&gt; 表 -&gt; 记录</li>
</ul>
<ul>
<li>在一个数据服务中可以有多个数据库</li>
<li>在一个数据库中可以有多个集合<ul>
<li>在 MongoDB 中，把表称之为集合</li>
<li>集合简单理解就是一个数组</li>
</ul>
</li>
<li>在一个集合中可以有多个对象（json）（在mongodb 中称之为文档）,是一个特殊的 json 对象<ul>
<li>称之为 bson</li>
</ul>
</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  a: &#123; </div><div class="line">    users: [</div><div class="line">      &#123; username: 'xxx', password: 'xxx', age: 'xxx', gender: 'xx' &#125;,</div><div class="line">      &#123; username: 'xxx', password: 'xxx', age: 'xxx', gender: 'xx' &#125;</div><div class="line">      &#123; username: 'xxx', password: 'xxx', age: 'xxx', gender: 'xx' &#125;</div><div class="line">      &#123; username: 'xxx', password: 'xxx', age: 'xxx', gender: 'xx' &#125;</div><div class="line">      ...</div><div class="line">    ],</div><div class="line">    articles: [</div><div class="line">      &#123; title: 'xxx', content: '', time: '' &#125;,</div><div class="line">      &#123; title: 'xxx', content: '', time: '' &#125;,</div><div class="line">      &#123; title: 'xxx', content: '', time: '' &#125;,</div><div class="line">      &#123; title: 'xxx', content: '', time: '' &#125;,</div><div class="line">      &#123; title: 'xxx', content: '', time: '' &#125;,</div><div class="line">      ...</div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line">  b: &#123; </div><div class="line">    users: [</div><div class="line">      &#123; username: 'xxx', password: 'xxx', age: 'xxx', gender: 'xx' &#125;,</div><div class="line">      &#123; username: 'xxx', password: 'xxx', age: 'xxx', gender: 'xx' &#125;</div><div class="line">      &#123; username: 'xxx', password: 'xxx', age: 'xxx', gender: 'xx' &#125;</div><div class="line">      &#123; username: 'xxx', password: 'xxx', age: 'xxx', gender: 'xx' &#125;</div><div class="line">      ...</div><div class="line">    ],</div><div class="line">  &#125;,</div><div class="line">  c: &#123;  &#125;</div><div class="line">&#125;</div><div class="line">a 数据库</div><div class="line">   用户数据：用户集合[]</div><div class="line">   文章数据：文章集合[]</div><div class="line">   评论数据：评论集合[]</div><div class="line">   商品数据：商品集合[]</div><div class="line">   订单数据：订单集合[]</div><div class="line"></div><div class="line">b 数据库</div><div class="line"></div><div class="line">c 数据库</div></pre></td></tr></table></figure>
<h3 id="基本操作命令"><a href="#基本操作命令" class="headerlink" title="基本操作命令"></a>基本操作命令</h3><ul>
<li><code>show dbs</code><ul>
<li>查看当前服务实例上所有的数据库</li>
</ul>
</li>
<li><code>use 数据库名称</code><ul>
<li>这个命令表示切换到指定的数据库</li>
<li>如果没有，也不会创建</li>
<li>如果已经有了，则表示切换到这个数据库对该数据库进行操作</li>
<li>只有在你切换过去以后在这个数据库中添加了一个数据集合以后才会显示这个数据库</li>
<li>连接到数据库之后，默认有一个变量叫做：db，终端默认把 db 赋值给了 test</li>
</ul>
</li>
<li><code>db</code><ul>
<li>查看当前所处的数据库</li>
</ul>
</li>
<li><code>db.集合名称.insert(数据文档)</code></li>
<li><code>show collections</code><ul>
<li>查看当前数据库中所有的集合</li>
</ul>
</li>
<li><code>db.集合名称.find()</code><ul>
<li>查询指定集合中所有的数据</li>
<li>可以通过 <code>db.集合名称.find().pretty()</code> 美化输出格式</li>
<li>默认是查询所有，可以通过：<code>db.集合名称.find({查询条件})</code> 按条件查询集合中的数据</li>
</ul>
</li>
<li><code>db.集合名称.update({更新条件}, {要更新的字段})</code><ul>
<li>更新指定集合数据</li>
</ul>
</li>
<li><code>db.集合名称.remove({删除条件})</code><ul>
<li>删除指定集合中的数据</li>
</ul>
</li>
</ul>
<hr>
<h2 id="使用-MongoDB-官方提供的-mongodb-驱动包操作-MongoDB-数据库"><a href="#使用-MongoDB-官方提供的-mongodb-驱动包操作-MongoDB-数据库" class="headerlink" title="使用 MongoDB 官方提供的 mongodb 驱动包操作 MongoDB 数据库"></a>使用 MongoDB 官方提供的 mongodb 驱动包操作 MongoDB 数据库</h2><p>安装：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm i -S mongodb</div></pre></td></tr></table></figure>
<p>CRUD：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> mongodb = <span class="built_in">require</span>(<span class="string">'mongodb'</span>)</div><div class="line"></div><div class="line"><span class="comment">// 连接路径URL</span></div><div class="line"><span class="keyword">var</span> url = <span class="string">'mongodb://localhost:27017/itcast'</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> MongoClient = mongodb.MongoClient</div><div class="line"></div><div class="line"><span class="comment">// ================== 插入数据 ==================</span></div><div class="line"><span class="comment">// 1. 连接数据库（打开冰箱门）</span></div><div class="line"><span class="comment">// MongoClient.connect(url, function (err, db) &#123;</span></div><div class="line"><span class="comment">//   if (err) &#123;</span></div><div class="line"><span class="comment">//     throw new Error('连接失败')</span></div><div class="line"><span class="comment">//   &#125;</span></div><div class="line"></div><div class="line"><span class="comment">//   // 2. 把大象放到冰箱</span></div><div class="line"><span class="comment">//   db</span></div><div class="line"><span class="comment">//     .collection('heros')</span></div><div class="line"><span class="comment">//     .insert(&#123; name: '张飞', gender: '男', age: 23 &#125;, function (err, result) &#123;</span></div><div class="line"><span class="comment">//       if (err) &#123;</span></div><div class="line"><span class="comment">//         throw new Error('插入数据失败')</span></div><div class="line"><span class="comment">//       &#125;</span></div><div class="line"><span class="comment">//       console.log(result)</span></div><div class="line"></div><div class="line"><span class="comment">//       // 3. 关上冰箱门</span></div><div class="line"><span class="comment">//       db.close()</span></div><div class="line"><span class="comment">//     &#125;)</span></div><div class="line"><span class="comment">// &#125;)</span></div><div class="line"><span class="comment">// ================== /插入数据 ==================</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// ================== 查询数据 ==================</span></div><div class="line"><span class="comment">// MongoClient.connect(url, function (err, db) &#123;</span></div><div class="line"><span class="comment">//   if (err) &#123;</span></div><div class="line"><span class="comment">//     throw new Error('连接失败')</span></div><div class="line"><span class="comment">//   &#125;</span></div><div class="line"></div><div class="line"><span class="comment">//   // 查询所有</span></div><div class="line"><span class="comment">//   // db.collection('heros').find(&#123;&#125;).toArray(function (err, docs) &#123;</span></div><div class="line"><span class="comment">//   //   if (err) &#123;</span></div><div class="line"><span class="comment">//   //     throw new Error('查询数据失败')</span></div><div class="line"><span class="comment">//   //   &#125;</span></div><div class="line"><span class="comment">//   //   console.log(docs)</span></div><div class="line"><span class="comment">//   // &#125;)</span></div><div class="line"></div><div class="line"><span class="comment">//   // 按条件查询</span></div><div class="line"><span class="comment">//   db.collection('heros').find(&#123;name: '张飞'&#125;).toArray(function (err, docs) &#123;</span></div><div class="line"><span class="comment">//     if (err) &#123;</span></div><div class="line"><span class="comment">//       throw new Error('查询数据失败')</span></div><div class="line"><span class="comment">//     &#125;</span></div><div class="line"><span class="comment">//     console.log(docs)</span></div><div class="line"><span class="comment">//   &#125;)</span></div><div class="line"><span class="comment">// &#125;)</span></div><div class="line"><span class="comment">// ================== /查询数据 ==================</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// ================== 更新数据 ==================</span></div><div class="line"><span class="comment">// MongoClient.connect(url, function (err, db) &#123;</span></div><div class="line"><span class="comment">//   if (err) &#123;</span></div><div class="line"><span class="comment">//     throw new Error('连接失败')</span></div><div class="line"><span class="comment">//   &#125;</span></div><div class="line"><span class="comment">//   db.collection('heros').updateOne(&#123;name: '张飞'&#125;, &#123;</span></div><div class="line"><span class="comment">//     $set: &#123;</span></div><div class="line"><span class="comment">//       age: 20</span></div><div class="line"><span class="comment">//     &#125;</span></div><div class="line"><span class="comment">//   &#125;, function (err, result) &#123;</span></div><div class="line"><span class="comment">//     if (err) &#123;</span></div><div class="line"><span class="comment">//       throw new Error('更新失败')</span></div><div class="line"><span class="comment">//     &#125;</span></div><div class="line"><span class="comment">//     console.log(result)</span></div><div class="line"><span class="comment">//   &#125;)</span></div><div class="line"><span class="comment">// &#125;)</span></div><div class="line"><span class="comment">// ================== /更新数据 ==================</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// ================== 删除数据 ==================</span></div><div class="line"><span class="comment">// MongoClient.connect(url, function (err, db) &#123;</span></div><div class="line"><span class="comment">//   if (err) &#123;</span></div><div class="line"><span class="comment">//     throw new Error('连接失败')</span></div><div class="line"><span class="comment">//   &#125;</span></div><div class="line"><span class="comment">//   db.collection('heros').deleteOne(&#123;name: '张飞'&#125;, function (err, result) &#123;</span></div><div class="line"><span class="comment">//     if (err) &#123;</span></div><div class="line"><span class="comment">//       throw new Error('删除失败')</span></div><div class="line"><span class="comment">//     &#125;</span></div><div class="line"><span class="comment">//     console.log(result)</span></div><div class="line"><span class="comment">//   &#125;)</span></div><div class="line"><span class="comment">// &#125;)</span></div><div class="line"><span class="comment">// ================== /删除数据 ==================</span></div></pre></td></tr></table></figure>
<h2 id="mongoose"><a href="#mongoose" class="headerlink" title="mongoose"></a>mongoose</h2><p>mongoose 是基于 mongodb 之上封装的一个 ORM 框架，<br>我们在使用的时候只需要关注业务数据模型就可以了。</p>
<ul>
<li>Github：<a href="https://github.com/Automattic/mongoose" target="_blank" rel="external">https://github.com/Automattic/mongoose</a></li>
<li>官网：<a href="http://mongoosejs.com/" target="_blank" rel="external">http://mongoosejs.com/</a></li>
<li>官方指南：<a href="http://mongoosejs.com/docs/guide.html" target="_blank" rel="external">http://mongoosejs.com/docs/guide.html</a></li>
</ul>
<h3 id="起步-1"><a href="#起步-1" class="headerlink" title="起步"></a>起步</h3><p>安装：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install --save mongoose</div></pre></td></tr></table></figure>
<p>hello world：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</div><div class="line">mongoose.connect(<span class="string">'mongodb://localhost/test'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> kittySchema = mongoose.Schema(&#123;</div><div class="line">    name: <span class="built_in">String</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">var</span> Kitten = mongoose.model(<span class="string">'Kitten'</span>, kittySchema);</div><div class="line"></div><div class="line"><span class="keyword">var</span> silence = <span class="keyword">new</span> Kitten(&#123; <span class="attr">name</span>: <span class="string">'Silence'</span> &#125;);</div><div class="line"><span class="built_in">console</span>.log(silence.name); <span class="comment">// 'Silence'</span></div><div class="line"></div><div class="line">silence.save(<span class="function"><span class="keyword">function</span> (<span class="params">err, fluffy</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="built_in">console</span>.error(err);</div><div class="line">  fluffy.speak();</div><div class="line">&#125;);</div><div class="line"></div><div class="line">Kitten.find(<span class="function"><span class="keyword">function</span> (<span class="params">err, kittens</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="built_in">console</span>.error(err);</div><div class="line">  <span class="built_in">console</span>.log(kittens);</div><div class="line">&#125;)</div><div class="line"></div><div class="line">Kitten.find(&#123; <span class="attr">name</span>: <span class="regexp">/^fluff/</span> &#125;, callback);</div></pre></td></tr></table></figure>
<h3 id="Schemas"><a href="#Schemas" class="headerlink" title="Schemas"></a>Schemas</h3><h4 id="SchemaTypes"><a href="#SchemaTypes" class="headerlink" title="SchemaTypes"></a>SchemaTypes</h4><ul>
<li>String</li>
<li>Number</li>
<li>Date</li>
<li>Buffer<ul>
<li>二进制类型</li>
</ul>
</li>
<li>Boolean</li>
<li>Mixed<ul>
<li>任意类型</li>
</ul>
</li>
<li>Objectid<ul>
<li>特殊的数据</li>
</ul>
</li>
<li>Array</li>
</ul>
<h4 id="定义-Schema-示例"><a href="#定义-Schema-示例" class="headerlink" title="定义 Schema 示例"></a>定义 Schema 示例</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> schema = <span class="keyword">new</span> Schema(&#123;</div><div class="line">  name:    <span class="built_in">String</span>,</div><div class="line">  binary:  Buffer,</div><div class="line">  living:  <span class="built_in">Boolean</span>,</div><div class="line">  updated: &#123; <span class="attr">type</span>: <span class="built_in">Date</span>, <span class="attr">default</span>: <span class="built_in">Date</span>.now &#125;,</div><div class="line">  age:     &#123; <span class="attr">type</span>: <span class="built_in">Number</span>, <span class="attr">min</span>: <span class="number">18</span>, <span class="attr">max</span>: <span class="number">65</span> &#125;,</div><div class="line">  mixed:   Schema.Types.Mixed,</div><div class="line">  _someId: Schema.Types.ObjectId,</div><div class="line">  array:      [],</div><div class="line">  ofString:   [<span class="built_in">String</span>],</div><div class="line">  ofNumber:   [<span class="built_in">Number</span>],</div><div class="line">  ofDates:    [<span class="built_in">Date</span>],</div><div class="line">  ofBuffer:   [Buffer],</div><div class="line">  ofBoolean:  [<span class="built_in">Boolean</span>],</div><div class="line">  ofMixed:    [Schema.Types.Mixed],</div><div class="line">  ofObjectId: [Schema.Types.ObjectId],</div><div class="line">  nested: &#123;</div><div class="line">    stuff: &#123; <span class="attr">type</span>: <span class="built_in">String</span>, <span class="attr">lowercase</span>: <span class="literal">true</span>, <span class="attr">trim</span>: <span class="literal">true</span> &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// example use</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> Thing = mongoose.model(<span class="string">'Thing'</span>, schema);</div><div class="line"></div><div class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> Thing;</div><div class="line">m.name = <span class="string">'Statue of Liberty'</span>;</div><div class="line">m.age = <span class="number">125</span>;</div><div class="line">m.updated = <span class="keyword">new</span> <span class="built_in">Date</span>;</div><div class="line">m.binary = <span class="keyword">new</span> Buffer(<span class="number">0</span>);</div><div class="line">m.living = <span class="literal">false</span>;</div><div class="line">m.mixed = &#123; <span class="attr">any</span>: &#123; <span class="attr">thing</span>: <span class="string">'i want'</span> &#125; &#125;;</div><div class="line">m.markModified(<span class="string">'mixed'</span>);</div><div class="line">m._someId = <span class="keyword">new</span> mongoose.Types.ObjectId;</div><div class="line">m.array.push(<span class="number">1</span>);</div><div class="line">m.ofString.push(<span class="string">"strings!"</span>);</div><div class="line">m.ofNumber.unshift(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>);</div><div class="line">m.ofDates.addToSet(<span class="keyword">new</span> <span class="built_in">Date</span>);</div><div class="line">m.ofBuffer.pop();</div><div class="line">m.ofMixed = [<span class="number">1</span>, [], <span class="string">'three'</span>, &#123; <span class="attr">four</span>: <span class="number">5</span> &#125;];</div><div class="line">m.nested.stuff = <span class="string">'good'</span>;</div><div class="line">m.save(callback);</div></pre></td></tr></table></figure>
<h4 id="SchemaType-Options"><a href="#SchemaType-Options" class="headerlink" title="SchemaType Options"></a>SchemaType Options</h4><p>加入验证的目的就是为了统一数据库中的数据的完整一致性。</p>
<ul>
<li><a href="http://mongoosejs.com/docs/guide.html" target="_blank" rel="external">http://mongoosejs.com/docs/guide.html</a></li>
</ul>
<p>基本约束：</p>
<ul>
<li>required: boolean or function, if true adds a required validator for this property<ul>
<li>必须约束</li>
</ul>
</li>
<li>default: Any or function, sets a default value for the path. If the value is a function, the return value of the function is used as the default.<ul>
<li>默认约束</li>
</ul>
</li>
<li>select: boolean, specifies default projections for queries</li>
<li>`validate: function, adds a validator function for this property<ul>
<li>自定义约束条件</li>
</ul>
</li>
<li>get: function, defines a custom getter for this property using Object.defineProperty().<ul>
<li>数据属性的 get 约束</li>
<li>当你访问该属性的时候会自动调用 get 方法</li>
</ul>
</li>
<li>set: function, defines a custom setter for this property using Object.defineProperty().<ul>
<li>数据属性的 set 约束</li>
<li>当你为数据属性赋值的时候会自动调用 set 方法</li>
</ul>
</li>
</ul>
<p>索引（暂时还不需要考虑）：</p>
<ul>
<li>index: boolean, whether to define an on this property.</li>
<li>unique: boolean, whether to define a unique index on this property.</li>
<li>sparse: boolean, whether to define a sparse index on this property.</li>
</ul>
<p>字符串：</p>
<ul>
<li>lowercase: boolean, whether to always call .toLowerCase() on the value<ul>
<li>自动转为小写</li>
</ul>
</li>
<li>uppercase: boolean, whether to always call .toUpperCase() on the value<ul>
<li>自动转为大写</li>
</ul>
</li>
<li>trim: boolean, whether to always call .trim() on the value<ul>
<li>自动去除空格</li>
</ul>
</li>
<li>match: RegExp, creates a validator that checks if the value matches the given regular expression<ul>
<li>自定义字符串的验证规则</li>
</ul>
</li>
<li>enum: Array, creates a validator that checks if the value is in the given array.<ul>
<li>枚举类型，必须是数组中指定的某个枚举元素</li>
</ul>
</li>
</ul>
<p>数字：</p>
<ul>
<li>min: Number, creates a validator that checks if the value is greater than or equal to the given minimum.<ul>
<li>限定最小数字</li>
</ul>
</li>
<li>max: Number, creates a validator that checks if the value is less than or equal to the given maximum.<ul>
<li>限定最大数字</li>
</ul>
</li>
</ul>
<p>日期：</p>
<ul>
<li>min: Date<ul>
<li>限定最小日期</li>
</ul>
</li>
<li>max: Date<ul>
<li>限定最大日期</li>
</ul>
</li>
</ul>
<h4 id="Models-模型"><a href="#Models-模型" class="headerlink" title="Models 模型"></a>Models 模型</h4><ul>
<li><a href="http://mongoosejs.com/docs/models.html" target="_blank" rel="external">http://mongoosejs.com/docs/models.html</a></li>
</ul>
<p>查询：</p>
<ul>
<li>find<ul>
<li>查询所有数据</li>
<li>或者按条件去查询</li>
</ul>
</li>
<li>findById<ul>
<li>根据ID查询单条数据</li>
</ul>
</li>
<li>findOne<ul>
<li>根据条件查询一个文档（哪怕有多个符合条件的也只要查到的第一个）</li>
</ul>
</li>
</ul>
<p>删除：</p>
<ul>
<li>remove<ul>
<li>根据条件删除所有符合条件的文档</li>
</ul>
</li>
<li>findOneAndRemove<ul>
<li>根据条件删除一个（即便有多个也只删一个）</li>
</ul>
</li>
<li>findByIdAndRemove<ul>
<li>根据 ID 删除一个</li>
</ul>
</li>
</ul>
<p>更新：</p>
<ul>
<li>update</li>
<li>findOneAndUpdate</li>
<li>findByIdAndUpdate</li>
</ul>
<p>获取集合总数：</p>
<ul>
<li>count</li>
</ul>
<p>聚合：</p>
<ul>
<li>aggregate</li>
</ul>
<h4 id="Document-文档对象"><a href="#Document-文档对象" class="headerlink" title="Document 文档对象"></a>Document 文档对象</h4><p>更新：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Tank.findById(id, <span class="function"><span class="keyword">function</span> (<span class="params">err, tank</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> handleError(err);</div><div class="line">  </div><div class="line">  tank.size = <span class="string">'large'</span>;</div><div class="line">  tank.save(<span class="function"><span class="keyword">function</span> (<span class="params">err, updatedTank</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (err) <span class="keyword">return</span> handleError(err);</div><div class="line">    res.send(updatedTank);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>或者：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Tank.update(&#123; <span class="attr">_id</span>: id &#125;, &#123; <span class="attr">$set</span>: &#123; <span class="attr">size</span>: <span class="string">'large'</span> &#125;&#125;, callback);</div></pre></td></tr></table></figure>
<p>或者：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Tank.findByIdAndUpdate(id, &#123; <span class="attr">$set</span>: &#123; <span class="attr">size</span>: <span class="string">'large'</span> &#125;&#125;, &#123; <span class="attr">new</span>: <span class="literal">true</span> &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">err, tank</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> handleError(err);</div><div class="line">  res.send(tank);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h4><p>注意：如果出现以及错误：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">(node:89456) DeprecationWarning: open() is deprecated in mongoose &gt;= 4.11.0, use openUri() instead, or set the useMongoClient option if using connect() or createConnection(). See http://mongo</div><div class="line"></div><div class="line">osejs.com/docs/connections.html#use-mongo-client</div><div class="line"></div><div class="line">(node:89456) DeprecationWarning: Mongoose: mpromise (mongoose&apos;s default promise library) is deprecated, plug in your own promise library instead: http://mongoosejs.com/docs/promises.html</div></pre></td></tr></table></figure>
<p>请加上：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mongoose.Promise = global.Promise;</div><div class="line"></div><div class="line">mongoose.connect(&apos;mongodb://localhost/itcast&apos;,&#123;useMongoClient:true&#125;);</div></pre></td></tr></table></figure>
<h3 id="Express-中间件"><a href="#Express-中间件" class="headerlink" title="Express 中间件"></a>Express 中间件</h3><p>​    中间件：从现实比喻就好比是自来水厂：污水从进入自来水厂到流通到用户中，需要经过一系列的处理环节，而其中的环节都可以称之为一个中间件,从 Express 框架执行流程来看，中间件就是一个处理函数，接收用户请求，通过一系列的中间件处理函数处理用户的请求，处理完毕，最后由其中某个中间件将结果响应给用户.</p>
<p>​    在 Express 中，中间件本质上就是一个函数：<br>    fucntion (req, res, next) { }<br>       req 是请求对象<br>       res 是响应对象<br>       next 是可选参数，表示下一个中间件</p>
<h4 id="中间件函数"><a href="#中间件函数" class="headerlink" title="中间件函数"></a>中间件函数</h4><p>​    在 Express 中，有三种形式的 API 可以添加或者调度中间件</p>
<pre><code>处理同一个请求的系列中间件中流通的都是同一个 req 和 res 对象
app.use(function (req, res) {})
    任何请求都会进入该中间件，不关心请求方法和请求路径
app.use(&apos;请求路径&apos;, function (req, res) {})
app.请求方法
    get
    post
</code></pre><h4 id="中间件执行流程"><a href="#中间件执行流程" class="headerlink" title="中间件执行流程"></a>中间件执行流程</h4><h4 id="中间件使用场景"><a href="#中间件使用场景" class="headerlink" title="中间件使用场景"></a>中间件使用场景</h4><p>​    在 Express 中使用中间件处理 404 页面</p>
<p>​    在 Express 中使用中间件全局处理错误</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/NodeJS/" rel="tag"># NodeJS</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/10/19/ajax无刷新技术/" rel="next" title="ajax 无刷新技术">
                <i class="fa fa-chevron-left"></i> ajax 无刷新技术
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/robin.jpg"
                alt="Robin" />
            
              <p class="site-author-name" itemprop="name">Robin</p>
              <p class="site-description motion-element" itemprop="description">秋名山上行人稀，<br> 常有车手较高低。<br> 如今车道依旧在，<br> 不见当年老司机。</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#NodeJS"><span class="nav-number">1.</span> <span class="nav-text">NodeJS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是-Node"><span class="nav-number">1.0.1.</span> <span class="nav-text">什么是  Node</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#为什么要学习NodeJS"><span class="nav-number">1.0.2.</span> <span class="nav-text">为什么要学习NodeJS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Node-应用场景"><span class="nav-number">1.0.3.</span> <span class="nav-text">Node 应用场景</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Node-的优势领域"><span class="nav-number">1.0.4.</span> <span class="nav-text">Node 的优势领域</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NodeJS-学习资源"><span class="nav-number">1.0.5.</span> <span class="nav-text">NodeJS 学习资源</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NodeJS-安装"><span class="nav-number">1.0.6.</span> <span class="nav-text">NodeJS 安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Node-中的组成"><span class="nav-number">1.0.7.</span> <span class="nav-text">Node 中的组成</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#path-环境变量"><span class="nav-number">1.0.8.</span> <span class="nav-text">path 环境变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#常用核心模块"><span class="nav-number">1.0.9.</span> <span class="nav-text">常用核心模块</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#NodeJS-版-hello-word"><span class="nav-number">1.0.9.1.</span> <span class="nav-text">NodeJS 版 hello word</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#NodeJS-读写文件"><span class="nav-number">1.0.9.2.</span> <span class="nav-text">NodeJS 读写文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#NodeJS-开启服务器"><span class="nav-number">1.0.9.3.</span> <span class="nav-text">NodeJS 开启服务器</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#构建HTTP服务"><span class="nav-number">1.0.10.</span> <span class="nav-text">构建HTTP服务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#渲染方式"><span class="nav-number">1.0.11.</span> <span class="nav-text">渲染方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#文件操作的同步与异步"><span class="nav-number">1.0.12.</span> <span class="nav-text">文件操作的同步与异步</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第三方模块：模板引擎的使用"><span class="nav-number">1.0.13.</span> <span class="nav-text">第三方模块：模板引擎的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#得到文件的状态"><span class="nav-number">1.0.14.</span> <span class="nav-text">得到文件的状态</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-nodemon-实现改完代码服务自动重启"><span class="nav-number">1.0.15.</span> <span class="nav-text">使用 nodemon 实现改完代码服务自动重启</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-nodemon-实现改完代码服务自动重启-1"><span class="nav-number">1.0.16.</span> <span class="nav-text">使用 nodemon 实现改完代码服务自动重启</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CommonJS-规范："><span class="nav-number">1.0.17.</span> <span class="nav-text">CommonJS 规范：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#文件上传第三方包：formidable"><span class="nav-number">1.0.18.</span> <span class="nav-text">文件上传第三方包：formidable</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Express"><span class="nav-number">1.1.</span> <span class="nav-text">Express</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#起步"><span class="nav-number">1.1.1.</span> <span class="nav-text">起步</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Express-中外置路由使用"><span class="nav-number">1.1.2.</span> <span class="nav-text">Express 中外置路由使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#在-Express-中处理静态资源"><span class="nav-number">1.1.3.</span> <span class="nav-text">在 Express 中处理静态资源</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-Express-中的路由"><span class="nav-number">1.1.4.</span> <span class="nav-text">使用 Express 中的路由</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#art-template-在-exporess-中的使用"><span class="nav-number">1.1.5.</span> <span class="nav-text">art-template 在 exporess 中的使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MongoDB"><span class="nav-number">1.2.</span> <span class="nav-text">MongoDB</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#介绍"><span class="nav-number">1.2.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装"><span class="nav-number">1.2.2.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#启动和停止"><span class="nav-number">1.2.3.</span> <span class="nav-text">启动和停止</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#连接-MongoDB"><span class="nav-number">1.2.4.</span> <span class="nav-text">连接 MongoDB</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MongoDB-数据存储结构"><span class="nav-number">1.2.5.</span> <span class="nav-text">MongoDB 数据存储结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基本操作命令"><span class="nav-number">1.2.6.</span> <span class="nav-text">基本操作命令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用-MongoDB-官方提供的-mongodb-驱动包操作-MongoDB-数据库"><span class="nav-number">1.3.</span> <span class="nav-text">使用 MongoDB 官方提供的 mongodb 驱动包操作 MongoDB 数据库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mongoose"><span class="nav-number">1.4.</span> <span class="nav-text">mongoose</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#起步-1"><span class="nav-number">1.4.1.</span> <span class="nav-text">起步</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Schemas"><span class="nav-number">1.4.2.</span> <span class="nav-text">Schemas</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#SchemaTypes"><span class="nav-number">1.4.2.1.</span> <span class="nav-text">SchemaTypes</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#定义-Schema-示例"><span class="nav-number">1.4.2.2.</span> <span class="nav-text">定义 Schema 示例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SchemaType-Options"><span class="nav-number">1.4.2.3.</span> <span class="nav-text">SchemaType Options</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Models-模型"><span class="nav-number">1.4.2.4.</span> <span class="nav-text">Models 模型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Document-文档对象"><span class="nav-number">1.4.2.5.</span> <span class="nav-text">Document 文档对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#查询"><span class="nav-number">1.4.2.6.</span> <span class="nav-text">查询</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Express-中间件"><span class="nav-number">1.4.3.</span> <span class="nav-text">Express 中间件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#中间件函数"><span class="nav-number">1.4.3.1.</span> <span class="nav-text">中间件函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#中间件执行流程"><span class="nav-number">1.4.3.2.</span> <span class="nav-text">中间件执行流程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#中间件使用场景"><span class="nav-number">1.4.3.3.</span> <span class="nav-text">中间件使用场景</span></a></li></ol></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Robin</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  

  

  

</body>
</html>
